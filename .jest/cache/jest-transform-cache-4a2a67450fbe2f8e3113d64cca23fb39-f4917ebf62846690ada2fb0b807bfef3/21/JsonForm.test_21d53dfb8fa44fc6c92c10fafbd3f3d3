7b2cbfb6a9d7c716155430a4650ce638
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

Object.defineProperty(exports, "__esModule", {
  value: true
});

var tslib_1 = require("tslib");

var core_1 = require("@bluebase/core");

var JsonForm_1 = require("../JsonForm");

var index_1 = tslib_1.__importDefault(require("../../index"));

var react_1 = tslib_1.__importDefault(require("react"));

var enzyme_1 = require("enzyme");

var enzyme_async_helpers_1 = require("enzyme-async-helpers");

var fields = [{
  label: 'Username',
  name: 'username',
  required: true,
  type: 'text'
}, {
  schema: {
    component: 'Text',
    text: 'Text Component'
  },
  type: 'component'
}, {
  label: 'Temp',
  max: 32,
  min: 16,
  name: 'temp',
  step: 1,
  type: 'range'
}];
var initialValues = {
  temp: 26,
  username: ''
};
describe('FormFields', function () {
  it('should render all form fields in the schema', function _callee() {
    var onSubmit, component;
    return _regenerator.default.async(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            onSubmit = jest.fn();
            component = enzyme_1.mount(react_1.default.createElement(core_1.BlueBaseApp, {
              plugins: [index_1.default]
            }, react_1.default.createElement(JsonForm_1.JsonForm, {
              schema: {
                fields: fields,
                initialValues: initialValues,
                onSubmit: onSubmit
              }
            })));
            _context.next = 4;
            return _regenerator.default.awrap(enzyme_async_helpers_1.waitForElement(component, JsonForm_1.JsonForm));

          case 4:
            expect(component.find('FormFields').children()).toHaveLength(3);
            expect(component.find('FormFields').childAt(0).prop('name')).toBe('username');
            expect(component.find('FormFields').childAt(1).prop('name')).toBe('1-component');
            expect(component.find('FormFields').childAt(2).prop('name')).toBe('temp');

          case 8:
          case "end":
            return _context.stop();
        }
      }
    });
  });
  it('should hook into the form to modify the schema', function _callee2() {
    var onSubmit, filter, component;
    return _regenerator.default.async(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            onSubmit = jest.fn();

            filter = function filter(schema) {
              schema.fields.push({
                schema: {
                  component: 'Text',
                  text: 'New Injected Text Component'
                },
                type: 'component'
              });
              return schema;
            };

            component = enzyme_1.mount(react_1.default.createElement(core_1.BlueBaseApp, {
              plugins: [index_1.default],
              filters: {
                'pluggable-form': filter
              }
            }, react_1.default.createElement(JsonForm_1.JsonForm, {
              schema: {
                fields: fields,
                initialValues: initialValues,
                onSubmit: onSubmit
              },
              filter: "pluggable-form"
            })));
            _context2.next = 5;
            return _regenerator.default.awrap(enzyme_async_helpers_1.waitForElement(component, JsonForm_1.JsonForm));

          case 5:
            expect(component.find('FormFields').children()).toHaveLength(4);
            expect(component.find('FormFields').childAt(0).prop('name')).toBe('username');
            expect(component.find('FormFields').childAt(1).prop('name')).toBe('1-component');
            expect(component.find('FormFields').childAt(2).prop('name')).toBe('temp');
            expect(component.find('FormFields').childAt(3).prop('name')).toBe('3-component');

          case 10:
          case "end":
            return _context2.stop();
        }
      }
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL211enphbWlsL0RvY3VtZW50cy9ibHVlYmFzZS9wbHVnaW4tanNvbi1zY2hlbWEtY29tcG9uZW50cy9zcmMvSnNvbkZvcm0vX190ZXN0c19fL0pzb25Gb3JtLnRlc3QudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsTUFBQSxHQUFBLE9BQUEsQ0FBQSxnQkFBQSxDQUFBOztBQUVBLElBQUEsVUFBQSxHQUFBLE9BQUEsQ0FBQSxhQUFBLENBQUE7O0FBQ0EsSUFBQSxPQUFBLEdBQUEsT0FBQSxDQUFBLGVBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxPQUFBLEdBQUEsT0FBQSxDQUFBLGVBQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxRQUFBLEdBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQTs7QUFDQSxJQUFBLHNCQUFBLEdBQUEsT0FBQSxDQUFBLHNCQUFBLENBQUE7O0FBRUEsSUFBTSxNQUFNLEdBQXFCLENBQUM7QUFDakMsRUFBQSxLQUFLLEVBQUUsVUFEMEI7QUFFakMsRUFBQSxJQUFJLEVBQUUsVUFGMkI7QUFHakMsRUFBQSxRQUFRLEVBQUUsSUFIdUI7QUFJakMsRUFBQSxJQUFJLEVBQUU7QUFKMkIsQ0FBRCxFQUs5QjtBQUNGLEVBQUEsTUFBTSxFQUFFO0FBQUUsSUFBQSxTQUFTLEVBQUUsTUFBYjtBQUFxQixJQUFBLElBQUksRUFBRTtBQUEzQixHQUROO0FBRUYsRUFBQSxJQUFJLEVBQUU7QUFGSixDQUw4QixFQVE5QjtBQUNGLEVBQUEsS0FBSyxFQUFFLE1BREw7QUFFRixFQUFBLEdBQUcsRUFBRSxFQUZIO0FBR0YsRUFBQSxHQUFHLEVBQUUsRUFISDtBQUlGLEVBQUEsSUFBSSxFQUFFLE1BSko7QUFLRixFQUFBLElBQUksRUFBRSxDQUxKO0FBTUYsRUFBQSxJQUFJLEVBQUU7QUFOSixDQVI4QixDQUFqQztBQWlCQSxJQUFNLGFB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QXpCLGVBQVQ7QUFBOEMsY0FBQSxNQUFNLEVBQUM7QUFBckQsYUFBVCxDQURELENBRGlCLENBZGtDO0FBQUE7QUFBQSw4Q0FvQjlDLHNCQUFBLENBQUEsY0FBQSxDQUFlLFNBQWYsRUFBaUMsVUFBQSxDQUFBLFFBQWpDLENBcEI4Qzs7QUFBQTtBQXlCcEQsWUFBQSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQVYsQ0FBZSxZQUFmLEVBQTZCLFFBQTdCLEVBQUQsQ0FBTixDQUFnRCxZQUFoRCxDQUE2RCxDQUE3RDtBQUNBLFlBQUEsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFWLENBQWUsWUFBZixFQUE2QixPQUE3QixDQUFxQyxDQUFyQyxFQUF3QyxJQUF4QyxDQUE2QyxNQUE3QyxDQUFELENBQU4sQ0FBNkQsSUFBN0QsQ0FBa0UsVUFBbEU7QUFDQSxZQUFBLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBVixDQUFlLFlBQWYsRUFBNkIsT0FBN0IsQ0FBcUMsQ0FBckMsRUFBd0MsSUFBeEMsQ0FBNkMsTUFBN0MsQ0FBRCxDQUFOLENBQTZELElBQTdELENBQWtFLGFBQWxFO0FBQ0EsWUFBQSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQVYsQ0FBZSxZQUFmLEVBQTZCLE9BQTdCLENBQXFDLENBQXJDLEVBQXdDLElBQXhDLENBQTZDLE1BQTdDLENBQUQsQ0FBTixDQUE2RCxJQUE3RCxDQUFrRSxNQUFsRTtBQUNBLFlBQUEsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFWLENBQWUsWUFBZixFQUE2QixPQUE3QixDQUFxQyxDQUFyQyxFQUF3QyxJQUF4QyxDQUE2QyxNQUE3QyxDQUFELENBQU4sQ0FBNkQsSUFBN0QsQ0FBa0UsYUFBbEU7O0FBN0JvRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUFuRCxDQUFGO0FBZ0NBLENBekRPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCbHVlQmFzZUFwcCB9IGZyb20gJ0BibHVlYmFzZS9jb3JlJztcbmltcG9ydCB7IEZvcm1GaWVsZFByb3BzIH0gZnJvbSAnLi4vRmllbGRzJztcbmltcG9ydCB7IEpzb25Gb3JtIH0gZnJvbSAnLi4vSnNvbkZvcm0nO1xuaW1wb3J0IFBsdWdpbiBmcm9tICcuLi8uLi9pbmRleCc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbW91bnQgfSBmcm9tICdlbnp5bWUnO1xuaW1wb3J0IHsgd2FpdEZvckVsZW1lbnQgfSBmcm9tICdlbnp5bWUtYXN5bmMtaGVscGVycyc7XG5cbmNvbnN0IGZpZWxkczogRm9ybUZpZWxkUHJvcHNbXSA9IFt7XG5cdGxhYmVsOiAnVXNlcm5hbWUnLFxuXHRuYW1lOiAndXNlcm5hbWUnLFxuXHRyZXF1aXJlZDogdHJ1ZSxcblx0dHlwZTogJ3RleHQnLFxufSwge1xuXHRzY2hlbWE6IHsgY29tcG9uZW50OiAnVGV4dCcsIHRleHQ6ICdUZXh0IENvbXBvbmVudCcgfSxcblx0dHlwZTogJ2NvbXBvbmVudCcsXG59LCB7XG5cdGxhYmVsOiAnVGVtcCcsXG5cdG1heDogMzIsXG5cdG1pbjogMTYsXG5cdG5hbWU6ICd0ZW1wJyxcblx0c3RlcDogMSxcblx0dHlwZTogJ3JhbmdlJyxcbn1dO1xuXG5jb25zdCBpbml0aWFsVmFsdWVzID0ge1xuXHQvLyAnYXV0by1sb2dpbic6IHRydWUsXG5cdC8vIGxhbmc6ICdqcycsXG5cdC8vIHBhc3N3b3JkOiAnJyxcblx0Ly8gcmVtZW1iZXI6IHRydWUsXG5cdHRlbXA6IDI2LFxuXHR1c2VybmFtZTogJycsXG59O1xuXG5cbmRlc2NyaWJlKCdGb3JtRmllbGRzJywgKCkgPT4ge1xuXG5cblx0aXQoJ3Nob3VsZCByZW5kZXIgYWxsIGZvcm0gZmllbGRzIGluIHRoZSBzY2hlbWEnLCBhc3luYyAoKSA9PiB7XG5cblx0XHRjb25zdCBvblN1Ym1pdCA9IGplc3QuZm4oKTtcblxuXHRcdGNvbnN0IGNvbXBvbmVudCA9IG1vdW50KFxuXHRcdFx0PEJsdWVCYXNlQXBwIHBsdWdpbnM9e1tQbHVnaW5dfT5cblx0XHRcdFx0PEpzb25Gb3JtIHNjaGVtYT17eyBmaWVsZHMsIGluaXRpYWxWYWx1ZXMsIG9uU3VibWl0IH19IC8+XG5cdFx0XHQ8L0JsdWVCYXNlQXBwPlxuXHRcdCk7XG5cblx0XHRhd2FpdCB3YWl0Rm9yRWxlbWVudChjb21wb25lbnQgYXMgYW55LCBKc29uRm9ybSk7XG5cblx0XHQvLyBleHBlY3QoY29tcG9uZW50KS50b01hdGNoU25hcHNob3QoKTtcblxuXHRcdC8vIENoZWNrIGZpZWxkc1xuXHRcdGV4cGVjdChjb21wb25lbnQuZmluZCgnRm9ybUZpZWxkcycpLmNoaWxkcmVuKCkpLnRvSGF2ZUxlbmd0aCgzKTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDApLnByb3AoJ25hbWUnKSkudG9CZSgndXNlcm5hbWUnKTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDEpLnByb3AoJ25hbWUnKSkudG9CZSgnMS1jb21wb25lbnQnKTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDIpLnByb3AoJ25hbWUnKSkudG9CZSgndGVtcCcpO1xuXHR9KTtcblxuXG5cdGl0KCdzaG91bGQgaG9vayBpbnRvIHRoZSBmb3JtIHRvIG1vZGlmeSB0aGUgc2NoZW1hJywgYXN5bmMgKCkgPT4ge1xuXG5cdFx0Y29uc3Qgb25TdWJtaXQgPSBqZXN0LmZuKCk7XG5cblx0XHRjb25zdCBmaWx0ZXIgPSAoc2NoZW1hOiBhbnkpID0+IHtcblxuXHRcdFx0c2NoZW1hLmZpZWxkcy5wdXNoKHtcblx0XHRcdFx0c2NoZW1hOiB7IGNvbXBvbmVudDogJ1RleHQnLCB0ZXh0OiAnTmV3IEluamVjdGVkIFRleHQgQ29tcG9uZW50JyB9LFxuXHRcdFx0XHR0eXBlOiAnY29tcG9uZW50Jyxcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gc2NoZW1hO1xuXHRcdH07XG5cblx0XHRjb25zdCBjb21wb25lbnQgPSBtb3VudChcblx0XHRcdDxCbHVlQmFzZUFwcCBwbHVnaW5zPXtbUGx1Z2luXX0gZmlsdGVycz17eyAncGx1Z2dhYmxlLWZvcm0nOiBmaWx0ZXIgfX0+XG5cdFx0XHRcdDxKc29uRm9ybSBzY2hlbWE9e3sgZmllbGRzLCBpbml0aWFsVmFsdWVzLCBvblN1Ym1pdCB9fSBmaWx0ZXI9XCJwbHVnZ2FibGUtZm9ybVwiIC8+XG5cdFx0XHQ8L0JsdWVCYXNlQXBwPlxuXHRcdCk7XG5cblx0XHRhd2FpdCB3YWl0Rm9yRWxlbWVudChjb21wb25lbnQgYXMgYW55LCBKc29uRm9ybSk7XG5cblx0XHQvLyBleHBlY3QoY29tcG9uZW50KS50b01hdGNoU25hcHNob3QoKTtcblxuXHRcdC8vIENoZWNrIGZpZWxkc1xuXHRcdGV4cGVjdChjb21wb25lbnQuZmluZCgnRm9ybUZpZWxkcycpLmNoaWxkcmVuKCkpLnRvSGF2ZUxlbmd0aCg0KTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDApLnByb3AoJ25hbWUnKSkudG9CZSgndXNlcm5hbWUnKTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDEpLnByb3AoJ25hbWUnKSkudG9CZSgnMS1jb21wb25lbnQnKTtcblx0XHRleHBlY3QoY29tcG9uZW50LmZpbmQoJ0Zvcm1GaWVsZHMnKS5jaGlsZEF0KDIpLnByb3AoJ25hbWUnKSkudG9CZSgndGVtcCcpO1xuXHRcdGV4cGVjdChjb21wb25lbnQuZmluZCgnRm9ybUZpZWxkcycpLmNoaWxkQXQoMykucHJvcCgnbmFtZScpKS50b0JlKCczLWNvbXBvbmVudCcpO1xuXHR9KTtcblxufSk7XG4iXX0=
32b50257ef864d30803d45cb3c4d172b
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var SwitchNativeComponent = require('SwitchNativeComponent');

var Platform = require('Platform');

var React = require('React');

var StyleSheet = require('StyleSheet');

var Switch = function (_React$Component) {
  (0, _inherits2.default)(Switch, _React$Component);

  function Switch() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, Switch);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(Switch)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_handleChange", function (event) {
      if (_this._nativeSwitchRef == null) {
        return;
      }

      var value = _this.props.value === true;

      if (Platform.OS === 'android') {
        _this._nativeSwitchRef.setNativeProps({
          on: value
        });
      } else {
        _this._nativeSwitchRef.setNativeProps({
          value: value
        });
      }

      if (_this.props.onChange != null) {
        _this.props.onChange(event);
      }

      if (_this.props.onValueChange != null) {
        _this.props.onValueChange(event.nativeEvent.value);
      }
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_handleSwitchNativeComponentRef", function (ref) {
      _this._nativeSwitchRef = ref;
    });
    return _this;
  }

  (0, _createClass2.default)(Switch, [{
    key: "render",
    value: function render() {
      var _props$accessibilityR;

      var _this$props = this.props,
          disabled = _this$props.disabled,
          ios_backgroundColor = _this$props.ios_backgroundColor,
          onChange = _this$props.onChange,
          onValueChange = _this$props.onValueChange,
          style = _this$props.style,
          thumbColor = _this$props.thumbColor,
          trackColor = _this$props.trackColor,
          value = _this$props.value,
          props = (0, _objectWithoutProperties2.default)(_this$props, ["disabled", "ios_backgroundColor", "onChange", "onValueChange", "style", "thumbColor", "trackColor", "value"]);
      var _thumbColor = thumbColor;

      var _trackColorForFalse = trackColor == null ? void 0 : trackColor.false;

      var _trackColorForTrue = trackColor == null ? void 0 : trackColor.true;

      var _ref = props,
          thumbTintColor = _ref.thumbTintColor,
          tintColor = _ref.tintColor,
          onTintColor = _ref.onTintColor;

      if (thumbTintColor != null) {
        _thumbColor = thumbTintColor;

        if (__DEV__) {
          console.warn('Switch: `thumbTintColor` is deprecated, use `thumbColor` instead.');
        }
      }

      if (tintColor != null) {
        _trackColorForFalse = tintColor;

        if (__DEV__) {
          console.warn('Switch: `tintColor` is deprecated, use `trackColor` instead.');
        }
      }

      if (onTintColor != null) {
        _trackColorForTrue = onTintColor;

        if (__DEV__) {
          console.warn('Switch: `onTintColor` is deprecated, use `trackColor` instead.');
        }
      }

      var platformProps = Platform.OS === 'android' ? {
        enabled: disabled !== true,
        on: value === true,
        style: style,
        thumbTintColor: _thumbColor,
        trackTintColor: value === true ? _trackColorForTrue : _trackColorForFalse
      } : {
        disabled: disabled,
        onTintColor: _trackColorForTrue,
        style: StyleSheet.compose({
          height: 31,
          width: 51
        }, StyleSheet.compose(style, ios_backgroundColor == null ? null : {
          backgroundColor: ios_backgroundColor,
          borderRadius: 16
        })),
        thumbTintColor: _thumbColor,
        tintColor: _trackColorForFalse,
        value: value === true
      };
      return React.createElement(SwitchNativeComponent, (0, _extends2.default)({}, props, platformProps, {
        accessibilityRole: (_props$accessibilityR = props.accessibilityRole) != null ? _props$accessibilityR : 'button',
        onChange: this._handleChange,
        onResponderTerminationRequest: returnsFalse,
        onStartShouldSetResponder: returnsTrue,
        ref: this._handleSwitchNativeComponentRef
      }));
    }
  }]);
  return Switch;
}(React.Component);

var returnsFalse = function returnsFalse() {
  return false;
};

var returnsTrue = function returnsTrue() {
  return true;
};

module.exports = Switch;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN3aXRjaC5qcyJdLCJuYW1lcyI6WyJTd2l0Y2hOYXRpdmVDb21wb25lbnQiLCJyZXF1aXJlIiwiUGxhdGZvcm0iLCJSZWFjdCIsIlN0eWxlU2hlZXQiLCJTd2l0Y2giLCJldmVudCIsIl9uYXRpdmVTd2l0Y2hSZWYiLCJ2YWx1ZSIsInByb3BzIiwiT1MiLCJzZXROYXRpdmVQcm9wcyIsIm9uIiwib25DaGFuZ2UiLCJvblZhbHVlQ2hhbmdlIiwibmF0aXZlRXZlbnQiLCJyZWYiLCJkaXNhYmxlZCIsImlvc19iYWNrZ3JvdW5kQ29sb3IiLCJzdHlsZSIsInRodW1iQ29sb3IiLCJ0cmFja0NvbG9yIiwiX3RodW1iQ29sb3IiLCJfdHJhY2tDb2xvckZvckZhbHNlIiwiZmFsc2UiLCJfdHJhY2tDb2xvckZvclRydWUiLCJ0cnVlIiwidGh1bWJUaW50Q29sb3IiLCJ0aW50Q29sb3IiLCJvblRpbnRDb2xvciIsIl9fREVWX18iLCJjb25zb2xlIiwid2FybiIsInBsYXRmb3JtUHJvcHMiLCJlbmFibGVkIiwidHJhY2tUaW50Q29sb3IiLCJjb21wb3NlIiwiaGVpZ2h0Iiwid2lkdGgiLCJiYWNrZ3JvdW5kQ29sb3IiLCJib3JkZXJSYWRpdXMiLCJhY2Nlc3NpYmlsaXR5Um9sZSIsIl9oYW5kbGVDaGFuZ2UiLCJyZXR1cm5zRmFsc2UiLCJyZXR1cm5zVHJ1ZSIsIl9oYW5kbGVTd2l0Y2hOYXRpdmVDb21wb25lbnRSZWYiLCJDb21wb25lbnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFVQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQU1BLHFCQUFxQixHQUFHQyxPQUFPLENBQUMsdUJBQUQsQ0FBckM7O0FBQ0EsSUFBTUMsUUFBUSxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFDQSxJQUFNRSxLQUFLLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXJCOztBQUNBLElBQU1HLFVBQVUsR0FBR0gsT0FBTyxDQUFDLFlBQUQsQ0FBMUI7O0lB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c291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgU3dpdGNoTmF0aXZlQ29tcG9uZW50ID0gcmVxdWlyZSgnU3dpdGNoTmF0aXZlQ29tcG9uZW50Jyk7XG5jb25zdCBQbGF0Zm9ybSA9IHJlcXVpcmUoJ1BsYXRmb3JtJyk7XG5jb25zdCBSZWFjdCA9IHJlcXVpcmUoJ1JlYWN0Jyk7XG5jb25zdCBTdHlsZVNoZWV0ID0gcmVxdWlyZSgnU3R5bGVTaGVldCcpO1xuXG5pbXBvcnQgdHlwZSB7U3dpdGNoQ2hhbmdlRXZlbnR9IGZyb20gJ0NvcmVFdmVudFR5cGVzJztcbmltcG9ydCB0eXBlIHtDb2xvclZhbHVlfSBmcm9tICdTdHlsZVNoZWV0VHlwZXMnO1xuaW1wb3J0IHR5cGUge1ZpZXdQcm9wc30gZnJvbSAnVmlld1Byb3BUeXBlcyc7XG5pbXBvcnQgdHlwZSB7TmF0aXZlQW5kcm9pZFByb3BzLCBOYXRpdmVJT1NQcm9wc30gZnJvbSAnU3dpdGNoTmF0aXZlQ29tcG9uZW50JztcblxuZXhwb3J0IHR5cGUgUHJvcHMgPSAkUmVhZE9ubHk8e3xcbiAgLi4uVmlld1Byb3BzLFxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBzd2l0Y2ggaXMgZGlzYWJsZWQuIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgKi9cbiAgZGlzYWJsZWQ/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogQm9vbGVhbiB2YWx1ZSBvZiB0aGUgc3dpdGNoLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICovXG4gIHZhbHVlPzogP2Jvb2xlYW4sXG5cbiAgLyoqXG4gICAqIEN1c3RvbSBjb2xvciBmb3IgdGhlIHN3aXRjaCB0aHVtYi5cbiAgICovXG4gIHRodW1iQ29sb3I/OiA/Q29sb3JWYWx1ZSxcblxuICAvKipcbiAgICogQ3VzdG9tIGNvbG9ycyBmb3IgdGhlIHN3aXRjaCB0cmFjay5cbiAgICpcbiAgICogTk9URTogT24gaU9TIHdoZW4gdGhlIHN3aXRjaCB2YWx1ZSBpcyBmYWxzZSwgdGhlIHRyYWNrIHNocmlua3MgaW50byB0aGVcbiAgICogYm9yZGVyLiBJZiB5b3Ugd2FudCB0byBjaGFuZ2UgdGhlIGNvbG9yIG9mIHRoZSBiYWNrZ3JvdW5kIGV4cG9zZWQgYnkgdGhlXG4gICAqIHNocnVua2VuIHRyYWNrLCB1c2UgYGlvc19iYWNrZ3JvdW5kQ29sb3JgLlxuICAgKi9cbiAgdHJhY2tDb2xvcj86ID8kUmVhZE9ubHk8e3xcbiAgICBmYWxzZT86ID9Db2xvclZhbHVlLFxuICAgIHRydWU/OiA/Q29sb3JWYWx1ZSxcbiAgfH0+LFxuXG4gIC8qKlxuICAgKiBPbiBpT1MsIGN1c3RvbSBjb2xvciBmb3IgdGhlIGJhY2tncm91bmQuIFRoaXMgYmFja2dyb3VuZCBjb2xvciBjYW4gYmUgc2VlblxuICAgKiBlaXRoZXIgd2hlbiB0aGUgc3dpdGNoIHZhbHVlIGlzIGZhbHNlIG9yIHdoZW4gdGhlIHN3aXRjaCBpcyBkaXNhYmxlZCAoYW5kXG4gICAqIHRoZSBzd2l0Y2ggaXMgdHJhbnNsdWNlbnQpLlxuICAgKi9cbiAgaW9zX2JhY2tncm91bmRDb2xvcj86ID9Db2xvclZhbHVlLFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgdXNlciB0cmllcyB0byBjaGFuZ2UgdGhlIHZhbHVlIG9mIHRoZSBzd2l0Y2guXG4gICAqXG4gICAqIFJlY2VpdmVzIHRoZSBjaGFuZ2UgZXZlbnQgYXMgYW4gYXJndW1lbnQuIElmIHlvdSB3YW50IHRvIG9ubHkgcmVjZWl2ZSB0aGVcbiAgICogbmV3IHZhbHVlLCB1c2UgYG9uVmFsdWVDaGFuZ2VgIGluc3RlYWQuXG4gICAqL1xuICBvbkNoYW5nZT86ID8oZXZlbnQ6IFN3aXRjaENoYW5nZUV2ZW50KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCxcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdGhlIHVzZXIgdHJpZXMgdG8gY2hhbmdlIHRoZSB2YWx1ZSBvZiB0aGUgc3dpdGNoLlxuICAgKlxuICAgKiBSZWNlaXZlcyB0aGUgbmV3IHZhbHVlIGFzIGFuIGFyZ3VtZW50LiBJZiB5b3Ugd2FudCB0byBpbnN0ZWFkIHJlY2VpdmUgYW5cbiAgICogZXZlbnQsIHVzZSBgb25DaGFuZ2VgLlxuICAgKi9cbiAgb25WYWx1ZUNoYW5nZT86ID8odmFsdWU6IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD4gfCB2b2lkLFxufH0+O1xuXG4vKipcbiAqIEEgdmlzdWFsIHRvZ2dsZSBiZXR3ZWVuIHR3byBtdXR1YWxseSBleGNsdXNpdmUgc3RhdGVzLlxuICpcbiAqIFRoaXMgaXMgYSBjb250cm9sbGVkIGNvbXBvbmVudCB0aGF0IHJlcXVpcmVzIGFuIGBvblZhbHVlQ2hhbmdlYCBjYWxsYmFjayB0aGF0XG4gKiB1cGRhdGVzIHRoZSBgdmFsdWVgIHByb3AgaW4gb3JkZXIgZm9yIHRoZSBjb21wb25lbnQgdG8gcmVmbGVjdCB1c2VyIGFjdGlvbnMuXG4gKiBJZiB0aGUgYHZhbHVlYCBwcm9wIGlzIG5vdCB1cGRhdGVkLCB0aGUgY29tcG9uZW50IHdpbGwgY29udGludWUgdG8gcmVuZGVyIHRoZVxuICogc3VwcGxpZWQgYHZhbHVlYCBwcm9wIGluc3RlYWQgb2YgdGhlIGV4cGVjdGVkIHJlc3VsdCBvZiBhbnkgdXNlciBhY3Rpb25zLlxuICovXG5jbGFzcyBTd2l0Y2ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgX25hdGl2ZVN3aXRjaFJlZjogP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFN3aXRjaE5hdGl2ZUNvbXBvbmVudD47XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRpc2FibGVkLFxuICAgICAgaW9zX2JhY2tncm91bmRDb2xvcixcbiAgICAgIG9uQ2hhbmdlLFxuICAgICAgb25WYWx1ZUNoYW5nZSxcbiAgICAgIHN0eWxlLFxuICAgICAgdGh1bWJDb2xvcixcbiAgICAgIHRyYWNrQ29sb3IsXG4gICAgICB2YWx1ZSxcbiAgICAgIC4uLnByb3BzXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAvLyBTdXBwb3J0IGRlcHJlY2F0ZWQgY29sb3IgcHJvcHMuXG4gICAgbGV0IF90aHVtYkNvbG9yID0gdGh1bWJDb2xvcjtcbiAgICBsZXQgX3RyYWNrQ29sb3JGb3JGYWxzZSA9IHRyYWNrQ29sb3I/LmZhbHNlO1xuICAgIGxldCBfdHJhY2tDb2xvckZvclRydWUgPSB0cmFja0NvbG9yPy50cnVlO1xuXG4gICAgLy8gVE9ETzogUmVtb3ZlIHN1cHBvcnQgZm9yIHRoZXNlIHByb3BzIGFmdGVyIGEgY291cGxlIHJlbGVhc2VzLlxuICAgIGNvbnN0IHt0aHVtYlRpbnRDb2xvciwgdGludENvbG9yLCBvblRpbnRDb2xvcn0gPSAocHJvcHM6ICRGbG93Rml4TWUpO1xuICAgIGlmICh0aHVtYlRpbnRDb2xvciAhPSBudWxsKSB7XG4gICAgICBfdGh1bWJDb2xvciA9IHRodW1iVGludENvbG9yO1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdTd2l0Y2g6IGB0aHVtYlRpbnRDb2xvcmAgaXMgZGVwcmVjYXRlZCwgdXNlIGB0aHVtYkNvbG9yYCBpbnN0ZWFkLicsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aW50Q29sb3IgIT0gbnVsbCkge1xuICAgICAgX3RyYWNrQ29sb3JGb3JGYWxzZSA9IHRpbnRDb2xvcjtcbiAgICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAnU3dpdGNoOiBgdGludENvbG9yYCBpcyBkZXByZWNhdGVkLCB1c2UgYHRyYWNrQ29sb3JgIGluc3RlYWQuJyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9uVGludENvbG9yICE9IG51bGwpIHtcbiAgICAgIF90cmFja0NvbG9yRm9yVHJ1ZSA9IG9uVGludENvbG9yO1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdTd2l0Y2g6IGBvblRpbnRDb2xvcmAgaXMgZGVwcmVjYXRlZCwgdXNlIGB0cmFja0NvbG9yYCBpbnN0ZWFkLicsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcGxhdGZvcm1Qcm9wcyA9XG4gICAgICBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnXG4gICAgICAgID8gKHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IGRpc2FibGVkICE9PSB0cnVlLFxuICAgICAgICAgICAgb246IHZhbHVlID09PSB0cnVlLFxuICAgICAgICAgICAgc3R5bGUsXG4gICAgICAgICAgICB0aHVtYlRpbnRDb2xvcjogX3RodW1iQ29sb3IsXG4gICAgICAgICAgICB0cmFja1RpbnRDb2xvcjpcbiAgICAgICAgICAgICAgdmFsdWUgPT09IHRydWUgPyBfdHJhY2tDb2xvckZvclRydWUgOiBfdHJhY2tDb2xvckZvckZhbHNlLFxuICAgICAgICAgIH06IE5hdGl2ZUFuZHJvaWRQcm9wcylcbiAgICAgICAgOiAoe1xuICAgICAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgICAgICBvblRpbnRDb2xvcjogX3RyYWNrQ29sb3JGb3JUcnVlLFxuICAgICAgICAgICAgc3R5bGU6IFN0eWxlU2hlZXQuY29tcG9zZShcbiAgICAgICAgICAgICAge2hlaWdodDogMzEsIHdpZHRoOiA1MX0sXG4gICAgICAgICAgICAgIFN0eWxlU2hlZXQuY29tcG9zZShcbiAgICAgICAgICAgICAgICBzdHlsZSxcbiAgICAgICAgICAgICAgICBpb3NfYmFja2dyb3VuZENvbG9yID09IG51bGxcbiAgICAgICAgICAgICAgICAgID8gbnVsbFxuICAgICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBpb3NfYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogMTYsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgdGh1bWJUaW50Q29sb3I6IF90aHVtYkNvbG9yLFxuICAgICAgICAgICAgdGludENvbG9yOiBfdHJhY2tDb2xvckZvckZhbHNlLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlID09PSB0cnVlLFxuICAgICAgICAgIH06IE5hdGl2ZUlPU1Byb3BzKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3dpdGNoTmF0aXZlQ29tcG9uZW50XG4gICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgey4uLnBsYXRmb3JtUHJvcHN9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPXtwcm9wcy5hY2Nlc3NpYmlsaXR5Um9sZSA/PyAnYnV0dG9uJ31cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMuX2hhbmRsZUNoYW5nZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e3JldHVybnNGYWxzZX1cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17cmV0dXJuc1RydWV9XG4gICAgICAgIHJlZj17dGhpcy5faGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgX2hhbmRsZUNoYW5nZSA9IChldmVudDogU3dpdGNoQ2hhbmdlRXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5fbmF0aXZlU3dpdGNoUmVmID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBGb3JjZSB2YWx1ZSBvZiBuYXRpdmUgc3dpdGNoIGluIG9yZGVyIHRvIGNvbnRyb2wgaXQuXG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlID09PSB0cnVlO1xuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnKSB7XG4gICAgICB0aGlzLl9uYXRpdmVTd2l0Y2hSZWYuc2V0TmF0aXZlUHJvcHMoe29uOiB2YWx1ZX0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9uYXRpdmVTd2l0Y2hSZWYuc2V0TmF0aXZlUHJvcHMoe3ZhbHVlfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMub25DaGFuZ2UgIT0gbnVsbCkge1xuICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZShldmVudCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMub25WYWx1ZUNoYW5nZSAhPSBudWxsKSB7XG4gICAgICB0aGlzLnByb3BzLm9uVmFsdWVDaGFuZ2UoZXZlbnQubmF0aXZlRXZlbnQudmFsdWUpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmID0gKFxuICAgIHJlZjogP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFN3aXRjaE5hdGl2ZUNvbXBvbmVudD4sXG4gICkgPT4ge1xuICAgIHRoaXMuX25hdGl2ZVN3aXRjaFJlZiA9IHJlZjtcbiAgfTtcbn1cblxuY29uc3QgcmV0dXJuc0ZhbHNlID0gKCkgPT4gZmFsc2U7XG5jb25zdCByZXR1cm5zVHJ1ZSA9ICgpID0+IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gU3dpdGNoO1xuIl19